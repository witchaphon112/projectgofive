<div class="flex flex-col min-h-[calc(100vh-140px)]">
  <h1 class="text-[28px] font-semibold text-[#0794FF] mb-6">Objectives</h1>

  <div class="flex flex-col md:flex-row items-center mb-6 space-y-4 md:space-y-0 md:space-x-4">
    <div class="relative w-full md:flex-1">
      <app-search-input (searchChange)="onSearch($event)"></app-search-input>
    </div>
    
    <div class="flex items-center gap-3"> 
      <button 
        (click)="openAddObjective()" 
        [disabled]="!canCreate"
        class="flex items-center gap-1 px-5 py-2.5 rounded-md text-sm font-medium transition-colors"
        [ngClass]="{
          'bg-[#4A85F6] hover:bg-[#335daa] text-white': canCreate,
          'bg-gray-300 text-gray-500 cursor-not-allowed': !canCreate
        }">
        Add Objective <mat-icon class="text-lg">add</mat-icon>
      </button>
      <app-sort-by [options]="sortOptions" (sortChange)="onSortChange($event)"></app-sort-by>
      <app-fillter 
        [availableStatuses]="availableStatuses()"
        [showRoles]="false"
        (filterChange)="onFilterChange($event)">
      </app-fillter>
    </div>
  </div>

  <div class="bg-white rounded-lg shadow-sm overflow-hidden mb-4">
    <div class="px-6 py-2 border-gray-200">
      <h2 class="text-lg font-semibold text-gray-900 m-0">Organizational Goals ({{ filteredObjectives().length }})</h2>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead class="bg-[#EFF4FA]">
          <tr class="h-14">
            <th class="px-6 py-3 text-left text-xs font-semibold text-[#8F9BB3] uppercase tracking-wider">Objective / Owner</th>
            <th class="px-6 py-3 text-left text-xs font-semibold text-[#8F9BB3] uppercase tracking-wider">Status</th>
            <th class="px-6 py-3 text-left text-xs font-semibold text-[#8F9BB3] uppercase tracking-wider">Start Date</th>
            <th class="px-6 py-3 text-left text-xs font-semibold text-[#8F9BB3] uppercase tracking-wider">Due Date</th>
            <th class="px-12 py-3 text-right text-xs font-semibold text-[#8F9BB3] uppercase tracking-wider">Action</th>
          </tr>
        </thead>
        
        <tbody class="bg-white divide-y divide-gray-100">
          @for (obj of filteredObjectives(); track obj.id) {
            <tr class="hover:bg-gray-50 transition-colors">
              <td class="px-16 py-4 min-w-[200px]">
                <div class="font-medium text-gray-900 mb-1">{{ obj.title }}</div>
                <div class="text-sm text-gray-500 flex items-center">
                  <mat-icon class="w-4 h-4 mr-1 text-gray-400">person</mat-icon> {{ obj.owner }}
                </div>
              </td>
              
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="inline-block px-3 py-1.5 rounded-2xl text-xs font-medium"
                      [ngClass]="{
                        'bg-green-100 text-green-800': obj.status === 'Complete',
                        'bg-blue-100 text-blue-800': obj.status === 'In Progress',
                        'bg-red-100 text-red-800': obj.status === 'Stuck',
                        'bg-gray-100 text-gray-800': obj.status === 'Pending' 
                      }">
                  {{ obj.status }}
                </span>
              </td>
              
              <td class="px-6 py-4 whitespace-nowrap text-gray-500">
                {{ obj.startDate | date: 'd MMM, y' }}
              </td>
              
              <td class="px-6 py-4 whitespace-nowrap text-gray-500">
                {{ obj.dueDate | date: 'd MMM, y' }}
              </td>

              <td class="px-6 py-4 whitespace-nowrap text-right">
                <button 
                  (click)="onEdit(obj.id)" 
                  [disabled]="!canEdit"
                  class="inline-flex items-center justify-center p-2 rounded transition-colors ml-2"
                  [ngClass]="{
                    'text-[#C5CEE0] hover:bg-gray-100 hover:text-[#0794FF]': canEdit,
                    'text-[#C5CEE0] cursor-not-allowed opacity-30': !canEdit
                  }"
                  title="Edit">
                  <mat-icon class="text-xl">edit</mat-icon>
                </button>
                
                <button 
                  (click)="onDelete(obj.id)" 
                  [disabled]="!canDelete"
                  class="inline-flex items-center justify-center p-2 rounded transition-colors"
                  [ngClass]="{
                    'text-[#C5CEE0] hover:bg-gray-100 hover:text-red-600': canDelete,
                    'text-[#C5CEE0] cursor-not-allowed opacity-30': !canDelete
                  }"
                  title="Delete">
                  <mat-icon class="text-xl">delete</mat-icon>
                </button>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="5" class="px-6 py-12 text-center text-gray-500 text-sm">
                @if (searchQuery()) {
                  No objectives found matching "{{ searchQuery() }}"
                } @else {
                  No objectives found
                }
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>